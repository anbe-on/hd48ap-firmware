#include QMK_KEYBOARD_H

// Global variable for OLED menu mode
uint8_t menu_mode = 0;

// Layers - From your JSON; uses LAYOUT macro from hd48ap.h to assign keycodes
// Relation: Each [layer] = LAYOUT(...) maps to matrix positions
const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
    [0] = LAYOUT(
        KC_TAB, KC_Q, KC_W, KC_E, KC_R, KC_T, KC_Y, KC_U, KC_I, KC_O, KC_P, KC_BSPC,
        KC_ESC, KC_A, KC_S, KC_D, KC_F, KC_G, KC_H, KC_J, KC_K, KC_L, KC_SCLN, KC_QUOT,
        KC_LSFT, KC_Z, KC_X, KC_C, KC_V, KC_B, KC_N, KC_M, KC_COMM, KC_DOT, KC_SLSH, KC_ENT,
        KC_LGUI, MO(2), MO(1), KC_LCTL, KC_LALT, KC_SPC, KC_SPC, MO(1), KC_APP, MO(2), KC_LBRC, KC_RBRC
    ),
    [1] = LAYOUT(
        KC_GRV, KC_1, KC_2, KC_3, KC_4, KC_5, KC_6, KC_7, KC_8, KC_9, KC_0, KC_BSPC,
        KC_ESC, KC_DEL, KC_BSPC, KC_ENT, KC_HOME, KC_END, KC_BSLS, KC_UP, KC_RGHT, KC_RCTL, KC_LBRC, KC_RBRC,
        KC_LSFT, KC_PGUP, KC_PGDN, KC_C, KC_V, KC_TAB, KC_LEFT, KC_DOWN, KC_RALT, KC_RSFT, KC_MINS, KC_EQL,
        KC_LGUI, KC_BRID, KC_BRIU, KC_LCTL, KC_LALT, KC_SPC, KC_SPC, KC_TRNS, KC_APP, KC_TRNS, KC_VOLD, KC_VOLU
    ),
    [2] = LAYOUT(
        KC_F1, KC_F2, KC_F3, KC_F4, KC_F5, KC_F6, KC_F7, KC_F8, KC_F9, KC_F10, KC_F11, KC_F12,
        KC_ESC, KC_DEL, KC_BSPC, KC_ENT, KC_NO, KC_NO, KC_NO, MS_UP, MS_RGHT, MS_BTN1, MS_WHLU, KC_BSPC,
        KC_LSFT, KC_PGUP, KC_PGDN, KC_C, KC_V, KC_HOME, MS_LEFT, MS_DOWN, KC_NO, MS_BTN2, MS_WHLD, KC_ENT,
        KC_LGUI, KC_NO, KC_NO, KC_LCTL, KC_LALT, KC_END, KC_SPC, AG_NORM, AG_SWAP, DB_TOGG, QK_RBT, QK_BOOT
    )
};

// Encoder - Switches menu_mode from config.h; called on rotation
// Relation: Uses config.h's menu_mode; affects oled_task_user()
bool encoder_update_user(uint8_t index, bool clockwise) {
    if (index == 0) {
        menu_mode = (menu_mode + (clockwise ? 1 : -1) + MENU_MODES) % MENU_MODES;
        return false;
    }
    return true;  // Pass to default
}

// Bongo template - 128x64 pixel (SSD1306); replace placeholders with bitmaps
// Relation: Used in oled_task_user() for mode 0
#define NUM_FRAMES 3
static const char PROGMEM image_frames[NUM_FRAMES][1024] = {
    // Frame 0:
    {
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xf3, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xfe, 0x5f, 0xde, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xe3, 0xbc, 0x6f, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xf7, 0xdf, 0xfc, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xd1, 0xdf, 0xe3, 0xce, 0x07, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0x3f, 0x9f, 0xcd, 0xfd, 0xff, 0xfd, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf9, 0xff, 0x1f, 0x3c, 0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xe7, 0xbe, 0x71, 0xff, 0x7d, 0xff, 0xfc, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfe, 0xff, 0x13, 0xff, 0xff, 0xfe, 0xff, 0xc0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xf7, 0xe3, 0xff, 0xff, 0xff, 0xff, 0x7e, 0xf4, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x7f, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xbd, 0xec, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfd, 0xc1, 0xff, 0xff, 0xbf, 0xff, 0xc7, 0xdc, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x36, 0x77, 0xff, 0xff, 0x3f, 0xff, 0xef, 0xfd, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xeb, 0xef, 0xff, 0xfe, 0x8f, 0xef, 0xf7, 0xdb, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x10, 0x1f, 0xfd, 0xfd, 0x7f, 0xff, 0xfb, 0x67, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xa0, 0x3f, 0xf9, 0xff, 0xde, 0xf7, 0xf8, 0x9f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x9c, 0x7f, 0xfb, 0xfb, 0xff, 0xf7, 0xfd, 0xdf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x3f, 0xfe, 0xf3, 0xff, 0xef, 0xf7, 0xfe, 0xe7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x7e, 0xde, 0xf3, 0xf7, 0xff, 0xf7, 0xfe, 0xf7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x7f, 0xff, 0xfb, 0xff, 0xf7, 0xf7, 0xff, 0x77, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x7d, 0xbd, 0xeb, 0xef, 0xfb, 0xf7, 0xff, 0x49, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x7e, 0xbd, 0xe9, 0xef, 0xfd, 0xff, 0xff, 0x4e, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfd, 0xbd, 0xe9, 0xff, 0xee, 0xef, 0xff, 0x9f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbc, 0x60, 0x7f, 0x01, 0xaf, 0xfc, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfc, 0x03, 0x5e, 0x7c, 0xdf, 0xfd, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0x8f, 0xff, 0xff, 0x5f, 0xfe, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdf, 0x9f, 0xff, 0xff, 0xbf, 0xfb, 0x6f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xe8, 0x3f, 0xff, 0xff, 0x6f, 0xfb, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf7, 0xbf, 0xff, 0xff, 0xdf, 0xf7, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf7, 0xbf, 0x00, 0xff, 0xbf, 0xef, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf1, 0x3f, 0xff, 0xff, 0x01, 0xdf, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf1, 0xbf, 0xff, 0xff, 0xfc, 0x7f, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0xbf, 0xff, 0xff, 0x7b, 0xff, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xdf, 0xff, 0xff, 0xf7, 0xff, 0x15, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xcf, 0xff, 0xfe, 0xff, 0xff, 0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xd3, 0xff, 0xfd, 0xe1, 0xff, 0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xb8, 0xff, 0xfd, 0xff, 0x3f, 0xbc, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xb3, 0x9f, 0xf3, 0xc0, 0xcf, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0x4e, 0xf8, 0x0b, 0xff, 0xf7, 0x7e, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0x3b, 0xf4, 0x07, 0xbf, 0xef, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0xff, 0xeb, 0xdf, 0xbf, 0xdf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfa, 0xff, 0xe8, 0x2f, 0xff, 0x3f, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf7, 0x70, 0x50, 0x1f, 0x7e, 0x7f, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xef, 0xb0, 0x0c, 0x1f, 0x7c, 0xbf, 0x9f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdf, 0x50, 0x04, 0x3f, 0x6d, 0x2f, 0x6f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbf, 0x40, 0x0a, 0x3f, 0xdb, 0xdf, 0x5f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbf, 0x80, 0x03, 0x7e, 0xf7, 0xd7, 0x67, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0x7e, 0x20, 0x00, 0x7e, 0xaf, 0xef, 0xef, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0x20, 0x00, 0xfe, 0xff, 0xef, 0xbb, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfe, 0xbe, 0x60, 0x00, 0xde, 0x7f, 0x23, 0xb7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbf, 0xd0, 0x14, 0x9f, 0xef, 0x77, 0xb7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0x3d, 0xf0, 0x34, 0x9f, 0xfd, 0x71, 0xf1, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfd, 0x3c, 0xe0, 0x3d, 0x1f, 0xff, 0x79, 0xd1, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfd, 0xbc, 0x60, 0x3f, 0x1f, 0xfa, 0x88, 0xd1, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfd, 0xbc, 0xe0, 0x7f, 0x1f, 0xfa, 0x70, 0xc1, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    },

    // Frame 1:
    {
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xcf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xbd, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xfe, 0xcf, 0xff, 0x6d, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xfd, 0xf9, 0x7d, 0x5f, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xfd, 0xff, 0x3d, 0x9f, 0xff, 0x80, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xe3, 0xfe, 0xfc, 0xbf, 0x33, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xdb, 0xe9, 0xf8, 0x7f, 0x1f, 0xe0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xdf, 0xff, 0xb4, 0xe7, 0xd8, 0xfe, 0xff, 0x80, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xbd, 0xff, 0x40, 0xc7, 0xf1, 0xfe, 0xfe, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xcf, 0xcf, 0x3f, 0x9f, 0xed, 0xe5, 0xfb, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xc3, 0xfe, 0xbf, 0x1f, 0xd9, 0xd3, 0xef, 0x81, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xe0, 0xfa, 0x3c, 0x0e, 0x1c, 0x43, 0x3f, 0x03, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xe1, 0x3b, 0x87, 0xff, 0xfe, 0x18, 0xfe, 0xe3, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xf7, 0xb3, 0x37, 0xff, 0xff, 0xfd, 0xff, 0x77, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfb, 0xbc, 0xbf, 0xff, 0xff, 0xfe, 0xff, 0xed, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfd, 0x92, 0x7f, 0xff, 0xff, 0xff, 0x7f, 0xaf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfe, 0xc9, 0xff, 0xff, 0xff, 0xff, 0xbe, 0xdf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xa3, 0xff, 0xbf, 0x9f, 0xff, 0xde, 0xbf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0x5f, 0xf7, 0xff, 0xff, 0xef, 0xed, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfe, 0xaf, 0xef, 0x7f, 0xef, 0xef, 0xf5, 0x5f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfd, 0x5f, 0xfb, 0xbe, 0xfd, 0xff, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfa, 0x8f, 0xce, 0xfe, 0xff, 0x57, 0xfb, 0xef, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfd, 0x9f, 0xde, 0xff, 0xfb, 0xf7, 0xfb, 0xcf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xf3, 0x1f, 0xbc, 0xfd, 0xfd, 0xf7, 0xfd, 0x8f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xef, 0x7f, 0x1d, 0x7d, 0xfe, 0xf7, 0xff, 0x2f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xe6, 0xff, 0x2f, 0xff, 0xff, 0x77, 0xfe, 0x79, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfe, 0xfe, 0x76, 0x9f, 0xff, 0xbf, 0xfe, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xef, 0xef, 0xff, 0xaf, 0xef, 0xef, 0xff, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xcf, 0xf7, 0x31, 0xfd, 0x01, 0xef, 0xff, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xef, 0xdb, 0x00, 0x7f, 0x38, 0xef, 0xfd, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfc, 0x9f, 0x7f, 0xfe, 0x7f, 0xfe, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xbf, 0xff, 0xff, 0xdf, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfb, 0xbf, 0xff, 0xff, 0xbf, 0xff, 0x5f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfb, 0xbf, 0xff, 0xff, 0x7f, 0xfb, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfb, 0xbf, 0xff, 0xfe, 0xcf, 0xfb, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf9, 0xbf, 0xff, 0xfc, 0xdf, 0xf7, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf9, 0xbf, 0xff, 0xff, 0xbf, 0xf7, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf8, 0xbf, 0xff, 0xfe, 0x79, 0xef, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xdf, 0xff, 0xff, 0xfd, 0xbf, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xaf, 0xff, 0xfe, 0xf8, 0xff, 0x0b, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xb7, 0xff, 0xfe, 0xf5, 0xff, 0x02, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xb9, 0xff, 0xff, 0xf7, 0xdf, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0x72, 0x7f, 0xf9, 0xec, 0xf7, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0x4e, 0xc4, 0x07, 0xef, 0xf7, 0xfd, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0xbb, 0xf8, 0x0b, 0xdf, 0xef, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0xef, 0xeb, 0xdf, 0xdf, 0xdf, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfd, 0x7f, 0xdb, 0xb7, 0xbf, 0xbf, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0x68, 0x10, 0x4f, 0xbf, 0x77, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfb, 0xb8, 0x07, 0x0f, 0xbe, 0xb7, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf7, 0x98, 0x02, 0x1f, 0x7d, 0x3f, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xef, 0x80, 0x04, 0x1f, 0x7b, 0xdf, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0x20, 0x21, 0xbf, 0x37, 0xff, 0x6f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xde, 0x20, 0x00, 0x3f, 0xef, 0xef, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbe, 0x70, 0x00, 0x7f, 0xdf, 0xff, 0xa7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbe, 0xf0, 0x00, 0x5e, 0xff, 0xb7, 0xbb, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0x6c, 0xb8, 0x08, 0x5e, 0xff, 0xf7, 0xf3, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0x6c, 0xf0, 0x14, 0x1e, 0xfd, 0x7b, 0xd7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0x4c, 0xf0, 0x1e, 0x9e, 0xff, 0x7b, 0xdd, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdc, 0xe0, 0x3e, 0x9e, 0xfa, 0x8d, 0xe1, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfe, 0xdc, 0xe0, 0x3f, 0x1e, 0xfe, 0x70, 0xc5, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    },

    // Frame 2:
    {
        0xff, 0xfd, 0x7b, 0x9f, 0x1f, 0xc7, 0x40, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf1, 0x7b, 0xee, 0xfb, 0xbe, 0x80, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf1, 0xbb, 0xf7, 0xfd, 0xbe, 0xa0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf8, 0xd8, 0x7a, 0xfd, 0xbd, 0x78, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xe8, 0xec, 0x0e, 0x06, 0x9a, 0xfc, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xe8, 0xec, 0x04, 0x02, 0xc7, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xe8, 0xf6, 0x03, 0x80, 0xec, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf8, 0xfb, 0x82, 0x80, 0xdb, 0x1e, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf3, 0x7c, 0x02, 0x81, 0xbb, 0xde, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfa, 0x7e, 0x40, 0x80, 0x77, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdd, 0xfe, 0x41, 0xcc, 0xf7, 0xd6, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdb, 0xbf, 0x03, 0xff, 0x7f, 0xf6, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdb, 0xbf, 0x5f, 0xf3, 0xcf, 0xf6, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdb, 0xbe, 0xff, 0xf9, 0xef, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdf, 0xfb, 0xff, 0xfd, 0xf7, 0xf7, 0xfb, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdd, 0xcf, 0xff, 0xfe, 0xfb, 0xf7, 0x4f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfb, 0xbf, 0xff, 0xfe, 0xfd, 0xfc, 0xdf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xec, 0xff, 0xff, 0xff, 0xfd, 0xf5, 0xef, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xea, 0xff, 0xff, 0xdf, 0xfe, 0xfb, 0xef, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xe1, 0xff, 0xbf, 0xbf, 0xff, 0x73, 0xef, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xd3, 0xff, 0xbf, 0xef, 0xff, 0x73, 0xf7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0x97, 0xf7, 0xff, 0x4f, 0xff, 0xab, 0xf7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfe, 0xaf, 0xfe, 0x3f, 0x7d, 0xbf, 0xfb, 0xf7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfd, 0x7f, 0xe3, 0x7e, 0xf7, 0xbf, 0xdb, 0xe7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfe, 0xdf, 0xcf, 0x7e, 0xfb, 0xbf, 0xfc, 0x8f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xfd, 0xf7, 0xcf, 0x7e, 0xfb, 0xbf, 0xec, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xf7, 0xaf, 0x87, 0x7f, 0xfd, 0xbf, 0xfc, 0x5f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xf3, 0x8f, 0x87, 0x7f, 0xfe, 0xbf, 0xf4, 0x4f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xef, 0x07, 0xdf, 0xff, 0x3f, 0xfd, 0xfb, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xaf, 0x36, 0x8d, 0xc7, 0xbf, 0xfb, 0xfc, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xe7, 0xaf, 0x19, 0xe5, 0x01, 0xbf, 0xfa, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xf7, 0xef, 0x40, 0x7e, 0x39, 0xbf, 0xee, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xf7, 0xeb, 0x47, 0x7f, 0xfc, 0xbf, 0xee, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xe5, 0x8f, 0xff, 0xfe, 0x7f, 0xe6, 0xbf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf5, 0x3f, 0xff, 0xff, 0x7f, 0xe0, 0xbf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfd, 0xff, 0xff, 0xff, 0x7f, 0xfa, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfd, 0xbf, 0xff, 0xfe, 0xdf, 0xda, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfd, 0xbf, 0xfd, 0xfd, 0xbf, 0xde, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfd, 0xbf, 0xff, 0xf2, 0x7f, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfc, 0xbf, 0xff, 0xfe, 0xff, 0xbe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfc, 0x5f, 0xff, 0xf9, 0xff, 0x7e, 0x7e, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0x9f, 0xff, 0xe7, 0xce, 0x7e, 0x9e, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0xef, 0xff, 0xfe, 0x6d, 0xfe, 0x9f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xf7, 0xff, 0xfe, 0xc7, 0xfe, 0xdd, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0xb9, 0xff, 0xfd, 0xee, 0x7e, 0xef, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0x78, 0x7f, 0xfd, 0xdf, 0xde, 0xeb, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfe, 0xe7, 0x1f, 0xf3, 0xdf, 0x66, 0xf3, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfd, 0xdd, 0xf8, 0x0b, 0xbf, 0xee, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xfb, 0xb7, 0xf4, 0x17, 0xbf, 0xdf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xf7, 0xff, 0xeb, 0xb7, 0xbd, 0xbe, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xef, 0x7f, 0xdc, 0x0f, 0xfb, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdf, 0xb8, 0x34, 0xcf, 0x76, 0x7e, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xdf, 0xb8, 0x0a, 0x1f, 0x7d, 0xbe, 0xbf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xff, 0x98, 0x00, 0x1f, 0x79, 0xbe, 0xbf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbf, 0x88, 0x05, 0x1f, 0xf7, 0xde, 0xdf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbf, 0x50, 0x01, 0xbe, 0xaf, 0xdf, 0xdf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbe, 0x30, 0x00, 0x3e, 0x5f, 0xe7, 0x4f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbe, 0x30, 0x00, 0x2e, 0xc0, 0xe7, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xbe, 0x78, 0x00, 0x2e, 0xff, 0xff, 0xe7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xae, 0xd8, 0x00, 0x0e, 0xff, 0x73, 0xa7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xae, 0xf8, 0x02, 0x0e, 0xff, 0x7b, 0xa7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xae, 0xf8, 0x17, 0x0e, 0xfb, 0x7b, 0xd3, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xae, 0xf0, 0x1f, 0x0e, 0xfe, 0x99, 0xc3, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff, 0xec, 0xf0, 0x3f, 0x0e, 0xfe, 0x68, 0xc1, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    },
};

// OLED - Called every frame; uses menu_mode from config.h
// Relation: Draws based on encoder; pixel-based for image (oled_write_raw_P), character-based for layers (oled_write_P)
bool oled_task_user(void) {
//    if (menu_mode == 0) {
//        uint8_t wpm = get_current_wpm();
//        uint8_t frame = (wpm / 10) % NUM_FRAMES;
//        oled_write_raw_P(image_frames[frame], 1024);
    if (menu_mode == 0) {
        static uint8_t frame = 0;
        static uint32_t last_update = 0;
        const uint32_t interval = 200; // milliseconds per frame (0.3 s)

        if (timer_elapsed32(last_update) > interval) {
            last_update = timer_read32();
            frame = (frame + 1) % NUM_FRAMES;
        }

        oled_write_raw_P(image_frames[frame], 1024);
    } else {
        uint8_t layer = menu_mode - 1;  // 1=Layer0, 2=Layer1, etc.
        oled_write_P(PSTR("Layer "), false);
        char buf[2] = {'0' + layer, '\0'};
        oled_write(buf, false);
        oled_write_P(PSTR(":\n"), false);
        // Text for layer (add per layer as before)
        if (layer == 0) {
            oled_write_P(PSTR(
                "TB  Q   W  E  R   T\n"
                "ES  A   S  D  F   G\n"
                "LS  Z   X  C  V   B\n"
                "UI MO2 MO1 CT AT SPC\n"
                "Layer 0 Left\n"
            ), false);
        }
        if (layer == 1) {
            oled_write_P(PSTR(
                "Y   U   I   O   P BS\n"
                "H   J   K   L   ; '\n"
                "N   M   ,   .   / EN\n"
                "SPC MO1 APP MO3 [ ]\n"
                "Layer 0 Right\n"
            ), false);
        }
        if (layer == 2) {
            oled_write_P(PSTR(
                "`   1   2  3  4   5\n"
                "ES DEL BS EN HOM END \n"
                "LS PUP PDN C  V  TAB\n"
                "UI BR- BR+ CT AT SPC\n"
                "Layer 1 Left\n"
            ), false);
        }
        if (layer == 3) {
            oled_write_P(PSTR(
                "6  7   8  9   0  BS\n"
                "\\  UP RT RCL [  ]\n"
                "LT DN RAT RSH -  =\n"
                "SPC - APP -  VO- VO+\n"
                "Layer 1 Right\n"
            ), false);
        }
        if (layer == 4) {
            oled_write_P(PSTR(
                "F1  F2  F3  F4 F5 F6\n"
                "ESC DEL BPC ENT - - \n"
                "LSH PUP PDN C V  HOM\n"
                "GUI -  - LCT LAT END\n"
                "Layer 2 Left\n"
            ), false);
        }
        if (layer == 5) {
            oled_write_P(PSTR(
                "F7 F8 F9 F10 F11 F12\n"
                "- MSU MSR LMB WHU BS\n"
                "MSL MSD - RMB WHD EN\n"
                "SPC AGN AGSdBtRBtBOT\n"
                "Layer 2 Right\n"
            ), false);
        }
    }
    return false;  // Don't process default
}
